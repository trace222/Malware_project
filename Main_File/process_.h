#pragma once
#include <windows.h>


#pragma comment(lib, "ntdll.lib")


class process
{
public:
	process();
	~process();

	HANDLE handle();
	bool create(PWCHAR pwszProcessPath, bool bSuspended = false);
	ULONG_PTR imagebase();
	bool unmap(ULONG_PTR imagebase);
	bool patchEntryPoint(ULONG_PTR baseAddress, ULONG_PTR addressOfEntryPoint);
	void resume();


private:
	bool getThreadContext();

private:
	bool check_Run;
	HANDLE _thread;
	HANDLE process_handle;
	LPCONTEXT _pthreadContext;
	ULONG_PTR process_handleImageBase;
};
